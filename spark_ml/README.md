# Spark ML и машинное обучение с помощью Spark 

## How-to 

Для запуска jupyter notebook с Python + Spark + Scala, наберите команду в текущей директории:
```bash
make run-jupyter
```

Затем скопируйте полученный токен и введите его локально в Jupyter http://localhost:8888

Дальнейшие шаги:
- Для начальной загрузки данных и построения Python модели в `sklearn` воспользуйтесь ноутбуком `create_python_model`.
- Для того чтобы провести инференс модели на Python, воспользуйтесь примером в `python_model_spark_inference`.
- Для того чтобы построить и применить модель целиком с помощью Spark ML, воспользуйтесь ноутбуком `create_spark_model`.

## Результат

Для построения модели на Apache Spark создан ноутбук `create_spark_random_forest_model`.

Модифицирован ноутбук `tweet_feeder` - при отправке данных в поток добавляется поле `timestamp` с текущей отметкой времени для использования в скользящем окне.

В ноутбуке `apply_model`:
- реализована функция для извлечения значения (1) из массива `probability`;
- модель применяется к потоку, и выводится это значение вероятности негативного твита;
- модель применяется к потоку, выполняется агрегация по скользящему окну 10 сек с watermark 15 сек, и выводится кол-во негативных и позитивных твитов.
